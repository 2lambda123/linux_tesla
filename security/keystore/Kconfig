config KEYSTORE
	bool "Generic Keystore"
	select CRYPTO_AES
	select CRYPTO_AES_NI_INTEL
	select CRYPTO_BLKCIPHER
	select CRYPTO_BLKCIPHER2
	select CRYPTO_RNG
	select CRYPTO_MANAGER
	select CRYPTO_CCM
	select CRYPTO_CTR
	select CRYPTO_SEQIV
	select CRYPTO_CBC
	select CRYPTO_HMAC
	select CRYPTO_CMAC
	select CRYPTO_SHA1
	select CRYPTO_SHA256
	select CRYPTO_SHA512
	select ASYMMETRIC_KEY_TYPE
	select ASYMMETRIC_PUBLIC_KEY_SUBTYPE
	select PUBLIC_KEY_ALGO_RSA
	select MPILIB
	help
		An IVI system deals with various keys that need to be stored
		securely on the platform. Some of the keys are stored in
		specific embedded hardware but others are required by
		algorithms running on Linux. The keystore is designed to
		provide a secure storage solution for such keys. Applications
		interface is through the char device ioctls on /dev/keystore.

	  	If in doubt, say "N".

choice
        prompt "Keystore seed type"
        depends on KEYSTORE
        default KEYSTORE_DEVICE_AND_USER_SEED
        help
          This option allows select which seed types are available in
          Keystore. Choose the default ("Device and User seed") unless you
          know that you need one of the others.

config KEYSTORE_DEVICE_AND_USER_SEED
        bool "Device and User seed"
        help
          This option allows both device and user seed.

          This is the default implementation choice. Choose this one unless
          you have a good reason not to.

config KEYSTORE_DEVICE_SEED_ONLY
        bool "Device seed only"
        help
          This option allows device seed only.

          Only choose this option if you know what you are doing.

config KEYSTORE_USER_SEED_ONLY
        bool "User seed only"
        help
          This option allows user seed only.

          Only choose this option if you know what you are doing.

endchoice

config KEYSTORE_TESTMODE
	bool "Diagnostic tests run on startup"
	depends on KEYSTORE
        default n
	help
                Runs self-test diagnostics when keystore is started.

                If unsure, select "N".

config KEYSTORE_HARD_CODED_SEED
	bool "Hard-coded SEEDs and Keys (WARNING: not for production!)"
	depends on KEYSTORE
        default n
	help
                Sets the keystore SEED and RSA public keys to fixed values instead
                of using values passed via the kernel command line.

                WARNING: This is only for testing purposes and should not be used
                for production as any data encrypted with keystore will be vulnerable
                to attack.

                If in doubt, select "N".

config KEYSTORE_TEST_MIGRATION
	bool "Migration Test Functions enabled"
	depends on KEYSTORE
        default n
	help
                Makes additional functions available to keystore for testing
                the backup and migration functions on a single machine.

                If unsure, select "N".

